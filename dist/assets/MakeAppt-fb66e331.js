import{c as K,b as Y,r as Z,a5 as J,u as W,a6 as X,a7 as $,a8 as D,j as e,L as T}from"./index-5d1582d4.js";import{N as o}from"./Notification-b903467d.js";import{C as ee,M as se}from"./index-99cabba6.js";import{a as te}from"./index-7633af43.js";import{u as ae}from"./useTranslation-57c75f11.js";import{S as re}from"./index-8ccb2d3a.js";import{F as l}from"./index-2daf2b68.js";import{I as f}from"./index-ef77481e.js";import{R as M}from"./index-3651fbdb.js";import{A as ie}from"./index-e9ae2b2e.js";import{E as le}from"./index-3f290c1a.js";import{B as p}from"./button-1dd3c86b.js";import{M as ne}from"./index-2499abbf.js";import{U as C}from"./UserOutlined-93acf3c1.js";import{L as me}from"./LockOutlined-f68f3a61.js";import"./render-43f47cb9.js";import"./asyncToGenerator-f41fc0b7.js";import"./ExclamationCircleFilled-3566f72d.js";import"./CloseOutlined-21301cb3.js";import"./useZIndex-412122f7.js";import"./useCSSVarCls-2b45069f.js";import"./Compact-de17ca2f.js";import"./EllipsisOutlined-5f99f7fa.js";import"./PlusOutlined-c3648a15.js";import"./useMergedState-a94f801d.js";import"./ResizeObserver.es-f4289e8a.js";import"./index-8ab4410e.js";import"./Dropdown-fc6ae30f.js";import"./index-3aef6c56.js";import"./Overflow-dad1924c.js";import"./iconBase-7dfc76c2.js";import"./reactNode-ed0d3403.js";import"./SearchOutlined-54091923.js";import"./index-98be3a7d.js";import"./collapse-97de76d4.js";import"./row-140c9d21.js";import"./responsiveObserver-74647030.js";import"./useLocale-98ce2b95.js";import"./compact-item-f6aa6deb.js";import"./index-c0762df4.js";import"./BaseInput-5f67969b.js";import"./pickAttrs-c42834d1.js";import"./index-949dd1fb.js";import"./useBreakpoint-945b7321.js";import"./useForceUpdate-3f4a0339.js";import"./useClosable-dc268733.js";import"./fade-72ecde73.js";import"./PurePanel-9c90c19c.js";const rs=()=>{var g,y,N,w,A,b,k,v;const{id:c}=K(),{t:s}=ae(),d=Y(),h=localStorage.getItem("role"),[S,x]=Z.useState(!1),{data:t,isLoading:E}=J(c||""),[F,{isLoading:B}]=W(),{data:n,isLoading:R}=X(),[O,{isLoading:V}]=$(),[q,{isLoading:z}]=D(),U=async r=>{var m,a,I;try{const{email:u,password:Q}=r,i=await F({email:u,password:Q,rememberMe:!0}).unwrap(),L=(m=i==null?void 0:i.data)==null?void 0:m.token,P=(a=i==null?void 0:i.data)==null?void 0:a.refreshToken,j=(I=i==null?void 0:i.data)==null?void 0:I.role;if(L&&P)localStorage.setItem("token",L),localStorage.setItem("rfToken",P),localStorage.setItem("role",j||""),o("success","Thành công","Đăng nhập thành công"),x(!1),window.location.reload(),j==="ADMIN"&&d("/admin"),j==="DOCTOR"&&d("/doctor");else throw new Error("Không có dữ liệu token hoặc refreshToken")}catch(u){o("error","Lỗi",u.data||"Có lỗi xảy ra")}},_=r=>{var m;((m=t==null?void 0:t.data)==null?void 0:m.whoPay)==="1"?O({...r,idSchedule:c}).unwrap().then(()=>{o("success","Thành công","Đặt lịch thành công!"),d("/vnpay_return",{state:{isFree:"Yes"}})}).catch(a=>{console.error(a),o("warning","Cảnh báo",a.data.message||a.data)}):q({...r,idSchedule:c}).unwrap().then(a=>{window.location.href=a.data.url}).catch(a=>{console.error(a),o("warning","Cảnh báo",a.data.message||a.data)})},G=()=>{x(!0)},H=()=>{x(!1)};return e.jsxs(re,{spinning:E,children:[e.jsx("div",{className:"bg-gray-100 py-8",children:e.jsxs("div",{className:"flex gap-4 items-start max-w-screen-md mx-auto px-12",children:[e.jsx("img",{src:(g=t==null?void 0:t.data)==null?void 0:g.doctorImg,alt:"",className:"w-28 h-28 rounded-full"}),e.jsxs("div",{className:"text-gray-700 brightness-125",children:[e.jsx("p",{className:"uppercase",children:s("makeAppt.booking")}),e.jsx("p",{className:"text-blue-600 font-medium text-lg",children:(y=t==null?void 0:t.data)==null?void 0:y.doctorName}),e.jsxs("p",{children:[(N=t==null?void 0:t.data)==null?void 0:N.startTime," - ",(w=t==null?void 0:t.data)==null?void 0:w.endTime," - ",(A=t==null?void 0:t.data)==null?void 0:A.date]}),e.jsx("p",{dangerouslySetInnerHTML:{__html:((b=t==null?void 0:t.data)==null?void 0:b.price)||""}})]})]})}),h==="USER"?e.jsx("div",{className:"max-w-screen-md mx-auto my-8",children:e.jsxs(l,{labelCol:{span:24},wrapperCol:{span:24},onFinish:_,children:[e.jsx(l.Item,{label:s("makeAppt.lableReason"),name:"reasonBooking",rules:[{required:!0,message:s("makeAppt.placeholderReason")}],children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(f.TextArea,{placeholder:s("makeAppt.placeholderReason"),style:{paddingLeft:"40px"},className:"py-1"}),e.jsx(te,{style:{position:"absolute",top:"10px",left:"19px"}})]})}),e.jsx(l.Item,{label:s("makeAppt.lableProfile"),name:"idProfile",initialValue:null,rules:[{required:!0,message:s("makeAppt.errorProfile")}],children:e.jsx(M.Group,{children:n!=null&&n.data&&n.data.length>0?n.data.map(r=>e.jsx(M,{value:r.id,style:{margin:"0 8px 8px 0"},children:e.jsx(ee,{style:{width:320},loading:R,children:e.jsx(se,{avatar:e.jsx(ie,{src:r.imgUrl,size:46}),title:r.fullName,description:r.genderValue||""})})},r.id)):e.jsx("div",{className:"flex justify-center items-center mx-auto w-[300%]",children:e.jsx(le,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:60},description:s("makeAppt.noProfile"),className:"flex flex-col items-center",children:e.jsx(T,{to:"/ho-so-kham-benh/them",className:"bg-blue-500 text-white p-2 rounded-md hover:text-white hover:bg-blue-400",children:s("makeAppt.createProfile")})})})})}),e.jsxs("div",{className:"bg-gray-50 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{children:s("makeAppt.priceExam")}),e.jsx("p",{children:s("makeAppt.descPrice")})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{children:s("makeAppt.priceBooking")}),e.jsx("p",{children:((k=t==null?void 0:t.data)==null?void 0:k.whoPay)==="1"?e.jsx("span",{children:s("makeAppt.free")}):e.jsx("span",{className:"text-red-500",children:Number((v=t==null?void 0:t.data)==null?void 0:v.bookingFee).toLocaleString("vi-VN",{style:"currency",currency:"VND"})})})]})]}),e.jsx("p",{className:"my-4 text-gray-500 text-center",children:s("makeAppt.notePrice")}),e.jsxs("div",{className:"bg-[#D4EFFC] py-4 px-8 leading-8 mb-8",children:[e.jsx("p",{className:"font-medium text-lg uppercase",children:s("makeAppt.note")}),e.jsx("p",{children:s("makeAppt.noteTitle")}),e.jsxs("ul",{className:"list-disc pl-4 ml-4",children:[e.jsx("li",{children:e.jsx("span",{children:s("makeAppt.noteDesc1")})}),e.jsx("li",{children:e.jsx("span",{children:s("makeAppt.noteDess2")})})]})]}),e.jsx(l.Item,{labelAlign:"left",children:e.jsx(p,{type:"primary",htmlType:"submit",className:"bg-blue-500 w-full",size:"large",loading:V||z,children:s("makeAppt.btnBooking")})})]})}):h==="DOCTOR"||h==="ADMIN"?e.jsx("div",{className:"max-w-screen-md mx-auto my-8",children:e.jsx(p,{type:"primary",danger:!0,className:" text-center w-full items-center flex justify-center cursor-not-allowed",children:s("makeAppt.noPowers")})}):e.jsx("div",{className:"max-w-screen-md mx-auto my-8",children:e.jsxs(p,{onClick:G,type:"primary",className:"bg-blue-500 w-full text-white items-center flex justify-center",size:"large",children:[e.jsx(C,{})," ",s("makeAppt.isBookingLogin")]})}),e.jsx(ne,{width:500,open:S,footer:null,onCancel:H,children:e.jsxs("section",{className:"bg-white",children:[e.jsx("h1",{className:"font-bold text-blue-500 text-3xl p-4",children:s("makeAppt.login")}),e.jsx("main",{className:"flex items-center justify-center mt-2",children:e.jsxs(l,{name:"normal_login",className:"login-form",labelCol:{span:24},wrapperCol:{span:24},initialValues:{remember:!0},onFinish:U,children:[e.jsx(l.Item,{label:s("makeAppt.labelEmail"),name:"email",rules:[{required:!0,message:s("makeAppt.errorEmail")}],children:e.jsx(f,{prefix:e.jsx(C,{className:"site-form-item-icon p-3"}),placeholder:s("makeAppt.placeholderEmail")})}),e.jsx(l.Item,{label:s("makeAppt.labelPassword"),name:"password",rules:[{required:!0,message:s("makeAppt.errorPassword")}],children:e.jsx(f.Password,{prefix:e.jsx(me,{className:"site-form-item-icon p-3"}),placeholder:s("makeAppt.placeholderEmail")})}),e.jsxs(l.Item,{className:"text-center",children:[e.jsx(p,{type:"primary",htmlType:"submit",className:"bg-blue-500 w-full",style:{height:"45px"},loading:B,children:s("makeAppt.btnLogin")}),e.jsx("p",{className:"my-2",children:s("makeAppt.or")}),e.jsxs("p",{children:[s("makeAppt.noAccount"),e.jsx(T,{to:"/register",className:"text-blue-500 hover:text-blue-800 hover:underline",children:s("makeAppt.signup")})]})]})]})})]})})]})};export{rs as default};
