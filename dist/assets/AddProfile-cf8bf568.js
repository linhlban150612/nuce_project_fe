import{b as w,r as n,ap as L,D as F,f as M,j as e}from"./index-5d1582d4.js";import{n as S}from"./index-d5b70956.js";import{d as x,c as C,D as q}from"./index-81ffed24.js";import{N as c}from"./Notification-b903467d.js";import{F as a}from"./index-2daf2b68.js";import{U as D}from"./index-1567c69b.js";import{I as r}from"./index-ef77481e.js";import{S as m}from"./index-a21a4ee5.js";import{B as O}from"./button-1dd3c86b.js";import{L as j}from"./compact-item-f6aa6deb.js";import{P as E}from"./PlusOutlined-c3648a15.js";import"./iconBase-7dfc76c2.js";import"./PurePanel-9c90c19c.js";import"./useMergedState-a94f801d.js";import"./Compact-de17ca2f.js";import"./ResizeObserver.es-f4289e8a.js";import"./pickAttrs-c42834d1.js";import"./index-8ab4410e.js";import"./Overflow-dad1924c.js";import"./useZIndex-412122f7.js";import"./SearchOutlined-54091923.js";import"./asyncToGenerator-f41fc0b7.js";import"./useCSSVarCls-2b45069f.js";import"./index-c0762df4.js";import"./move-8c08fc05.js";import"./index-98be3a7d.js";import"./reactNode-ed0d3403.js";import"./useLocale-98ce2b95.js";import"./render-43f47cb9.js";import"./ExclamationCircleFilled-3566f72d.js";import"./CloseOutlined-21301cb3.js";import"./collapse-97de76d4.js";import"./row-140c9d21.js";import"./responsiveObserver-74647030.js";import"./fade-72ecde73.js";import"./useForceUpdate-3f4a0339.js";import"./CheckOutlined-9e439339.js";import"./BaseInput-5f67969b.js";import"./index-3f290c1a.js";import"./DownOutlined-e8684ab4.js";const Ne=()=>{x.extend(C);const[l]=a.useForm(),b=w(),[h,f]=n.useState(null),[p,I]=n.useState(null),[g,u]=n.useState(!1),[y,{isLoading:T}]=L(),[N,{isLoading:v}]=F(),{data:i}=M();n.useEffect(()=>{var t;l.setFieldsValue({email:(t=i==null?void 0:i.data)==null?void 0:t.email})},[l,i]);const k=async t=>{I(t),u(!0),setTimeout(()=>{const s=URL.createObjectURL(t);f(s),u(!1)},2e3)},U=async t=>{delete t.imageObjectId,t.birthdate=x(t.birthdate).format("YYYY-MM-DD"),y(t).unwrap().then(s=>{const o=s==null?void 0:s.data,d=new FormData;p&&d.append("image",p),o&&d.append("id",o),N(d).unwrap().then(()=>{c("success","Thành công","Tạo hồ sơ khám bệnh thành công"),b("/ho-so-kham-benh")})}).catch(s=>{c("warning","Cảnh báo",s.data.message||s.data)})};return e.jsxs("div",{children:[e.jsx("h1",{className:"font-medium text-gray-800 text-xl mb-8",children:"Tạo hồ sơ bệnh nhân"}),e.jsxs(a,{form:l,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:700},initialValues:{remember:!0},labelWrap:!0,autoComplete:"off",className:"ml-20",onFinish:U,children:[e.jsxs("div",{className:"max-h-[450px] overflow-y-auto pr-8 mb-8 ",style:{scrollbarWidth:"thin"},children:[e.jsx(a.Item,{label:"Ảnh",name:"imageObjectId",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(D,{beforeUpload:t=>{const s="2";t.size/1024/1024<s?k(t):c("warning","Cảnh báo","Ảnh không được quá "+s.toString()+"MB")},showUploadList:!1,listType:"picture-circle",accept:"image/*",children:h?g?e.jsxs("div",{children:[e.jsx(j,{}),e.jsx("div",{style:{marginTop:8},children:"Đang tải ảnh..."})]}):e.jsx("img",{src:h,alt:"Ảnh đã upload",className:"max-h-[100px] max-w-[100px] rounded-full aspect-square object-cover"}):e.jsx("div",{children:g?e.jsxs("div",{children:[e.jsx(j,{}),e.jsx("div",{style:{marginTop:8},children:"Đang tải ảnh..."})]}):e.jsxs("div",{children:[e.jsx(E,{}),e.jsx("div",{style:{marginTop:8},children:"Upload"})]})})})}),e.jsx(a.Item,{label:"Họ và tên",name:"fullName",rules:[{required:!0,message:"Trường này không được bỏ trống !"},{min:6,message:"Họ tên phải trên 6 kí tự"}],children:e.jsx(r,{})}),e.jsx(a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Trường này không được bỏ trống !"},{type:"email",message:"Email không đúng định dạng"}],children:e.jsx(r,{})}),e.jsx(a.Item,{label:"Số điện thoại",name:"phoneNumber",rules:[{required:!0,message:"Trường này không được bỏ trống !"},{pattern:/^(0[0-9]{9,10})$/,message:"Số điện thoại không đúng định dạng"}],children:e.jsx(r,{})}),e.jsx(a.Item,{label:"Giới tính",name:"gender",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsxs(m,{children:[e.jsx(m.Option,{value:2,children:"Khác"}),e.jsx(m.Option,{value:1,children:"Nam"}),e.jsx(m.Option,{value:0,children:"Nữ"})]})}),e.jsx(a.Item,{label:"Ngày sinh",name:"birthdate",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(q,{showTime:!1,className:"w-full"})}),e.jsx(a.Item,{label:"Địa chỉ",name:"address",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(r,{})}),e.jsx(a.Item,{label:"Công việc",name:"job",children:e.jsx(r,{})}),e.jsx(a.Item,{label:"Mã CCCD/CMND",name:"cardId",children:e.jsx(r,{})}),e.jsx(a.Item,{label:"Mã thẻ bảo hiểm",name:"warrantyId",children:e.jsx(r,{})})]}),e.jsx(a.Item,{labelAlign:"left",children:e.jsx(O,{type:"primary",htmlType:"submit",className:"bg-blue-500",children:v||T?e.jsx(S,{className:"animate-spin"}):"Thêm hồ sơ"})})]})]})};export{Ne as default};
