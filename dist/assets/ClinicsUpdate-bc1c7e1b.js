import{c as me,b as he,r as o,y as pe,m as ue,p as ce,H as ge,I as xe,C as je,K as fe,D as ve,j as e,L as ye}from"./index-5d1582d4.js";import{d as Ce,C as be}from"./ckeditor-05c5dc69.js";import{n as Ie}from"./index-d5b70956.js";import{N as h}from"./Notification-b903467d.js";import{F as n}from"./index-2daf2b68.js";import{S as Le}from"./index-8ccb2d3a.js";import{R as Se,C as d}from"./row-140c9d21.js";import{I as W}from"./index-ef77481e.js";import{U as ke}from"./index-1567c69b.js";import{S as i}from"./index-a21a4ee5.js";import{R as I}from"./index-3651fbdb.js";import{B as Te}from"./button-1dd3c86b.js";import{E as Ue}from"./EnterOutlined-5a77cb95.js";import{L as _}from"./compact-item-f6aa6deb.js";import{P as we}from"./PlusOutlined-c3648a15.js";import"./iconBase-7dfc76c2.js";import"./render-43f47cb9.js";import"./asyncToGenerator-f41fc0b7.js";import"./ExclamationCircleFilled-3566f72d.js";import"./CloseOutlined-21301cb3.js";import"./useZIndex-412122f7.js";import"./useCSSVarCls-2b45069f.js";import"./index-8ab4410e.js";import"./useMergedState-a94f801d.js";import"./Compact-de17ca2f.js";import"./ResizeObserver.es-f4289e8a.js";import"./SearchOutlined-54091923.js";import"./index-98be3a7d.js";import"./reactNode-ed0d3403.js";import"./collapse-97de76d4.js";import"./useLocale-98ce2b95.js";import"./responsiveObserver-74647030.js";import"./index-c0762df4.js";import"./BaseInput-5f67969b.js";import"./pickAttrs-c42834d1.js";import"./fade-72ecde73.js";import"./useForceUpdate-3f4a0339.js";import"./CheckOutlined-9e439339.js";import"./Overflow-dad1924c.js";import"./PurePanel-9c90c19c.js";import"./index-3f290c1a.js";import"./move-8c08fc05.js";import"./DownOutlined-e8684ab4.js";import"./index-949dd1fb.js";const ya=()=>{var N,F,q,O,E,P,Q,V;const{id:L}=me(),S=he(),[l]=n.useForm(),[k,T]=o.useState(null),[c,X]=o.useState(null),[U,w]=o.useState(!1),[Z,g]=o.useState(""),[J,x]=o.useState(""),[j,Y]=o.useState(!1),{data:a,isLoading:$}=pe(L||""),{data:f,isLoading:D}=ue({search:"",province:"",status:"",page:0,resultLimit:100}),{data:v}=ce(),{data:y,isLoading:ee}=ge(Z),{data:C,isLoading:ae}=xe(J),{data:b}=je(),[se]=fe(),[te,{isLoading:ne}]=ve();o.useEffect(()=>{var s,t,r,p,m,u,G,H,M,R,A,B,z,K;l.setFieldsValue({descriptionHtml:(s=a==null?void 0:a.data)==null?void 0:s.descriptionHtml,name:(t=a==null?void 0:a.data)==null?void 0:t.name,status:(r=a==null?void 0:a.data)==null?void 0:r.status,hasChildren:(p=a==null?void 0:a.data)==null?void 0:p.hasChildren,province:(m=a==null?void 0:a.data)==null?void 0:m.province,district:(u=a==null?void 0:a.data)==null?void 0:u.district,ward:(G=a==null?void 0:a.data)==null?void 0:G.ward,address:(H=a==null?void 0:a.data)==null?void 0:H.addressName,imageObjectId:""}),(M=a==null?void 0:a.data)!=null&&M.imageUrl&&T((R=a==null?void 0:a.data)==null?void 0:R.imageUrl),(A=a==null?void 0:a.data)!=null&&A.district&&((B=a==null?void 0:a.data)!=null&&B.province)&&(x((z=a==null?void 0:a.data)==null?void 0:z.district),g((K=a==null?void 0:a.data)==null?void 0:K.province))},[a,l,x,g]);const re=s=>{g(s),l.setFieldValue("district",""),l.setFieldValue("ward","")},ie=s=>{x(s),l.setFieldValue("ward","")},de=s=>{Y(s.target.value)},le=async s=>{X(s),w(!0),setTimeout(()=>{const t=URL.createObjectURL(s);T(t),w(!1)},2e3)},oe=async s=>{try{delete s.imageObjectId;const t={id:L,...s};await se(t).unwrap().then(r=>{const p=r==null?void 0:r.data,m=new FormData;if(p&&m.append("id",p),c)m.append("image",c);else if(!c){h("success","Thành công","Sửa thành công"),S("/admin/quan-ly-phong-kham");return}te(m).unwrap().then(()=>{h("success","Thành công","Sửa thành công"),S("/admin/quan-ly-phong-kham")}).catch(u=>{h("error","Lỗi",u.data.message||u.message)})}).catch(r=>{h("error","Lỗi",r.data.message||r.message)})}catch(t){console.error("Error adding specialty:",t),h("error","Lỗi","Sửa không thành công")}};return e.jsxs("div",{className:"",children:[e.jsxs(ye,{to:"/admin/quan-ly-phong-kham",children:["Quay lại ",e.jsx(Ue,{})]}),e.jsx("h2",{className:"my-6 mx-16 text-2xl font-semibold",children:"Sửa phòng khám"}),e.jsx(Le,{spinning:$,children:e.jsxs(n,{className:"mx-40",form:l,name:"basic",labelCol:{span:24},wrapperCol:{span:24},onFinish:oe,labelWrap:!0,autoComplete:"off",children:[e.jsxs(Se,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(n.Item,{label:"Tên phòng khám",name:"name",rules:[{required:!0,message:"Trường này không được bỏ trống !"},{min:3,message:"Tối thiểu 3 ký tự!"}],children:e.jsx(W,{})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{label:"Ảnh",name:"imageObjectId",children:e.jsx(ke,{beforeUpload:s=>{const t="2";s.size/1024/1024<t?le(s):h("warning","Cảnh báo","Ảnh không được quá "+t.toString()+"MB")},showUploadList:!1,listType:"picture-card",accept:"image/*",children:k?U?e.jsxs("div",{children:[e.jsx(_,{}),e.jsx("div",{style:{marginTop:8},children:"Đang tải ảnh..."})]}):e.jsx("img",{src:k,alt:"Ảnh đã upload",style:{width:"100%"}}):e.jsx("div",{children:U?e.jsxs("div",{children:[e.jsx(_,{}),e.jsx("div",{style:{marginTop:8},children:"Đang tải ảnh..."})]}):e.jsxs("div",{children:[e.jsx(we,{}),e.jsx("div",{style:{marginTop:8},children:"Upload"})]})})})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{name:"province",label:"Tỉnh/Thành phố",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(i,{className:"w-full h-11",onChange:re,children:(N=v==null?void 0:v.data)==null?void 0:N.map(s=>e.jsx(i.Option,{value:s.code,children:s.name},s.code))})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{name:"district",label:"Quận/Huyện",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(i,{className:"w-full h-11",loading:ee,onChange:ie,children:(F=y==null?void 0:y.data)==null?void 0:F.map(s=>e.jsx(i.Option,{value:s.code,children:s.name},s.code))})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{name:"ward",label:"Phường/Xã",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(i,{className:"w-full h-11",loading:ae,children:(q=C==null?void 0:C.data)==null?void 0:q.map(s=>e.jsx(i.Option,{value:s.code,children:s.name},s.code))})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{label:"Địa chỉ",name:"address",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],children:e.jsx(W,{placeholder:"Địa chỉ",className:"p-3"})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{name:"isCurved",label:"Đây có phải là phòng khám con không?",children:e.jsxs(I.Group,{onChange:de,value:j,defaultValue:!1,children:[e.jsx(I,{value:!0,children:"Có"}),e.jsx(I,{value:!1,children:"Không"})]})})}),j&&e.jsx(d,{span:12,children:e.jsx(n.Item,{name:"parentClinicId",label:"Phòng khám cha",rules:[{required:j,message:"Trường này không được bỏ trống !"}],children:e.jsx(i,{className:"w-full h-11",loading:D,children:(E=(O=f==null?void 0:f.data)==null?void 0:O.data)==null?void 0:E.map(s=>e.jsx(i.Option,{value:s.id,children:s.name},s.id))})})}),e.jsx(d,{span:12,children:e.jsx(n.Item,{label:"Trạng thái",name:"status",rules:[{required:!0,message:"Trường này không được bỏ trống !"}],initialValue:(P=a==null?void 0:a.data)==null?void 0:P.status,children:e.jsx(i,{className:"w-full",children:(Q=b==null?void 0:b.data)==null?void 0:Q.map(s=>e.jsx(i.Option,{value:s.value,children:s.name},s.value))})})})]}),e.jsx(n.Item,{name:"descriptionHtml",label:"Mô tả",rules:[{required:!0,message:"Vui lòng không bỏ trống"}],children:e.jsx(Ce.CKEditor,{data:(V=a==null?void 0:a.data)==null?void 0:V.descriptionHtml,editor:be,onChange:(s,t)=>{const r=t.getData();l.setFieldsValue({descriptionHtml:r})}})}),e.jsx(n.Item,{labelAlign:"left",children:e.jsx(Te,{type:"primary",htmlType:"submit",className:"bg-blue-500",children:ne?e.jsx(Ie,{className:"animate-spin"}):"Cập nhật"})})]})})]})};export{ya as default};
