import{r as o,t as V,v as z,w as G,j as e}from"./index-5d1582d4.js";import{f as K,h as q,i as Q}from"./index-d5b70956.js";import{d as c,D as U}from"./index-81ffed24.js";import{N as D}from"./Notification-b903467d.js";import{u as X}from"./useTranslation-57c75f11.js";import{F as n}from"./index-2daf2b68.js";import{S as k}from"./index-a21a4ee5.js";import{B as l}from"./button-1dd3c86b.js";import{R as _}from"./ReloadOutlined-5d09a93f.js";import{S as $}from"./SearchOutlined-54091923.js";import{S as J}from"./index-8ccb2d3a.js";import{E as W}from"./index-3f290c1a.js";import{P as Z}from"./Pagination-bc2271f4.js";import{M as ee}from"./index-2499abbf.js";import{I as se}from"./index-ef77481e.js";import{F as te}from"./FrownTwoTone-71695f31.js";import"./iconBase-7dfc76c2.js";import"./PurePanel-9c90c19c.js";import"./useMergedState-a94f801d.js";import"./Compact-de17ca2f.js";import"./ResizeObserver.es-f4289e8a.js";import"./pickAttrs-c42834d1.js";import"./index-8ab4410e.js";import"./Overflow-dad1924c.js";import"./useZIndex-412122f7.js";import"./useCSSVarCls-2b45069f.js";import"./index-c0762df4.js";import"./compact-item-f6aa6deb.js";import"./move-8c08fc05.js";import"./index-98be3a7d.js";import"./reactNode-ed0d3403.js";import"./useLocale-98ce2b95.js";import"./render-43f47cb9.js";import"./asyncToGenerator-f41fc0b7.js";import"./ExclamationCircleFilled-3566f72d.js";import"./CloseOutlined-21301cb3.js";import"./collapse-97de76d4.js";import"./row-140c9d21.js";import"./responsiveObserver-74647030.js";import"./CheckOutlined-9e439339.js";import"./DownOutlined-e8684ab4.js";import"./LeftOutlined-79fdd531.js";import"./useBreakpoint-945b7321.js";import"./useForceUpdate-3f4a0339.js";import"./useClosable-dc268733.js";import"./fade-72ecde73.js";import"./BaseInput-5f67969b.js";const{RangePicker:ae}=U,Je=()=>{var f,N,y,C,b;const{t:u}=X(),[r]=n.useForm(),[m,w]=o.useState(1),[F,d]=o.useState(!1),[p,M]=o.useState({}),[Y,S]=o.useState(""),[i,{data:a,isLoading:L}]=V(),{data:h}=z(),[E,{isLoading:I}]=G();o.useEffect(()=>{j(m)},[]);const B=s=>{const t=s.name&&s.name[0]?c(s.name[0]).format("YYYY-MM-DD"):"",x=s.name&&s.name[1]?c(s.name[1]).format("YYYY-MM-DD"):"";i({fromDate:t,toDate:x,status:s.status,page:0,resultLimit:10})},P=()=>{r.resetFields(),i({fromDate:"",toDate:"",status:"",page:0,resultLimit:10})},g=s=>{M(t=>({...t,[s]:!t[s]}))},T=s=>{S(s),d(!0)},v=()=>{d(!1)},A=async s=>{await E({...s,idBooking:Y}).unwrap().then(()=>{D("success","Thành công","Huỷ đặt lịch thành công"),i({fromDate:"",toDate:"",status:"",page:m-1,resultLimit:10}),d(!1),r.submit()}).catch(t=>{D("error","Lỗi",t.data.message||t.data)})},H=s=>{w(s),j(s)},j=s=>{const t=r.getFieldValue("name"),x=t&&t[0]?c(t[0]).format("YYYY-MM-DD"):"",R=t&&t[1]?c(t[1]).format("YYYY-MM-DD"):"";i({fromDate:x,toDate:R,status:r.getFieldValue("status"),page:s-1,resultLimit:10})},O=s=>s.split(`
`).length;return e.jsxs("div",{className:"max-w-screen-xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-1 my-4 text-[#45C3D2]",children:[e.jsxs("a",{href:"/",className:"flex gap-1",children:[e.jsx(K,{className:"text-xl"}),"/"]}),e.jsxs("p",{children:[" ",u("history")]})]}),e.jsx("h2",{className:"font-bold text-xl mt-2 mb-5",children:u("history")}),e.jsx(n,{onFinish:B,form:r,className:"my-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(n.Item,{name:"name",children:e.jsx(ae,{placeholder:["Từ ngày","Đến ngày"]})}),e.jsx(n.Item,{name:"status",className:"w-44",children:e.jsx(k,{placeholder:"Trạng thái đặt lịch",className:"w-96",allowClear:!0,children:(f=h==null?void 0:h.data)==null?void 0:f.map(s=>e.jsx(k.Option,{value:s.value,children:s.name},s.value))})}),e.jsx(l,{icon:e.jsx(_,{}),onClick:P,children:"Đặt lại"}),e.jsx(l,{type:"primary",icon:e.jsx($,{}),className:"bg-blue-600",htmlType:"submit",children:"Tìm kiếm"})]})}),e.jsx(J,{spinning:L,children:e.jsx("div",{className:"grid grid-cols-1 gap-8 mx-24",children:(N=a==null?void 0:a.data)!=null&&N.data&&((y=a==null?void 0:a.data)==null?void 0:y.data.length)>0?(C=a==null?void 0:a.data)==null?void 0:C.data.map(s=>e.jsxs("div",{className:"grid grid-cols-4 items-center py-6 px-20 gap-4 border-2 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"col-span-1 flex flex-col gap-2 justify-center items-center ",children:[e.jsx("div",{className:"border-2 border-gray-200 p-2 rounded-full w-24 h-24 flex justify-center items-center",children:e.jsx("img",{src:s.patientProfile.imgUrl,alt:"",className:"w-20 h-20 object-cover rounded-full"})}),e.jsx("p",{className:"font-semibold text-[#49BCE2] uppercase text-lg",children:"Khám"}),e.jsxs("p",{className:"flex gap-2 items-center text-[#FFC10E]",children:[e.jsx(q,{className:"text-3xl"}),e.jsxs("span",{className:"text-lg font-medium",children:[s.timeStart,"-",s.timeEnd]})]}),e.jsxs("p",{className:"flex gap-2 items-center text-[#FFC10E]",children:[e.jsx(Q,{className:"text-3xl"}),e.jsx("span",{className:"text-lg font-medium",children:s.date})]})]}),e.jsxs("div",{className:"col-span-3 text-start grid grid-cols-1 gap-2 text-lg",children:[e.jsxs("p",{className:"font-semibold",children:["Bệnh nhân: ",s.patientProfile.fullName]}),e.jsxs("p",{children:["Bác sĩ : ",e.jsx("span",{className:"text-[#45C3D2]",children:s.doctorName})]}),e.jsxs("p",{children:["Nơi khám: ",s.clinicName]}),e.jsxs("p",{children:["Trạng thái:",s.status===1?e.jsx("span",{className:"text-green-500",children:" Đặt thành công"}):s.status===0?e.jsx("span",{className:"text-red-500",children:" Lịch đã huỷ"}):e.jsx("span",{className:"text-blue-500",children:" Đã khám xong"})]}),e.jsxs("p",{className:p[s.id]?"":"line-clamp-3",children:["Lý do khám: ",s.reasonBooking]}),O(s.reasonBooking)>3&&e.jsxs("span",{children:[!p[s.id]&&e.jsx(l,{type:"link",onClick:()=>g(s.id),children:"Xem thêm"}),p[s.id]&&e.jsx(l,{type:"link",onClick:()=>g(s.id),children:"Ẩn đi"})]}),s.status===0&&e.jsxs("p",{children:["Lý do huỷ: ",s.reasonCancel]}),e.jsx("button",{className:`text-center text-white px-6 py-3 mt-2 w-2/5 rounded-lg font-semibold
                                         ${s.isCancel===1?"bg-[#FFC20E] hover:bg-yellow-400 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`,disabled:s.isCancel!==1,onClick:()=>T(s.id),children:s.status===1?e.jsx("span",{children:"Huỷ lịch khám"}):s.status===0?"Lịch đã huỷ":"Đã khám xong"})]})]})):e.jsx(W,{image:e.jsx(te,{}),imageStyle:{fontSize:60},description:e.jsx("span",{children:"Không tìm thấy lịch khám phù hợp"})})})}),e.jsx(Z,{current:m,total:((b=a==null?void 0:a.data)==null?void 0:b.totalPages)*10,pageSize:10,onChange:H,className:"text-center mt-8"}),e.jsx(ee,{width:500,open:F,footer:null,onCancel:v,children:e.jsxs(n,{name:"normal_login",className:"login-form",labelCol:{span:24},wrapperCol:{span:24},initialValues:{remember:!0},onFinish:A,children:[e.jsx(n.Item,{label:"Lý do huỷ",name:"reasonCancel",rules:[{required:!0,message:"Vui lòng nhập lý do huỷ!!"}],children:e.jsx(se,{placeholder:"Nhập lý do huỷ"})}),e.jsx(n.Item,{className:"text-center",children:e.jsx(l,{type:"primary",htmlType:"submit",className:"bg-blue-500 w-full",style:{height:"45px"},loading:I,children:"Huỷ đặt lịch"})})]})})]})};export{Je as default};
