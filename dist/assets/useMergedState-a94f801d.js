import{r as n,aQ as j,aR as F,aS as T,aV as U,aJ as X,ak as J,X as O,b3 as k,ai as K,_ as Q,aI as P,U as B,ah as D}from"./index-5d1582d4.js";import{t as Y,a as L}from"./Compact-de17ca2f.js";import{i as q}from"./ResizeObserver.es-f4289e8a.js";var V=n.createContext(null);function G(e){var i=e.children,r=e.onBatchResize,a=n.useRef(0),t=n.useRef([]),u=n.useContext(V),c=n.useCallback(function(d,s,f){a.current+=1;var h=a.current;t.current.push({size:d,element:s,data:f}),Promise.resolve().then(function(){h===a.current&&(r==null||r(t.current),t.current=[])}),u==null||u(d,s,f)},[r,u]);return n.createElement(V.Provider,{value:c},i)}var l=new Map;function Z(e){e.forEach(function(i){var r,a=i.target;(r=l.get(a))===null||r===void 0||r.forEach(function(t){return t(a)})})}var N=new q(Z);function ee(e,i){l.has(e)||(l.set(e,new Set),N.observe(e)),l.get(e).add(i)}function re(e,i){l.has(e)&&(l.get(e).delete(i),l.get(e).size||(N.unobserve(e),l.delete(e)))}var te=function(e){j(r,e);var i=F(r);function r(){return T(this,r),i.apply(this,arguments)}return U(r,[{key:"render",value:function(){return this.props.children}}]),r}(n.Component);function ne(e,i){var r=e.children,a=e.disabled,t=n.useRef(null),u=n.useRef(null),c=n.useContext(V),d=typeof r=="function",s=d?r(t):r,f=n.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),h=!d&&n.isValidElement(s)&&X(s),R=h?s.ref:null,y=J(R,t),C=function(){var v;return k(t.current)||(t.current&&K(t.current)==="object"?k((v=t.current)===null||v===void 0?void 0:v.nativeElement):null)||k(u.current)};n.useImperativeHandle(i,function(){return C()});var _=n.useRef(e);_.current=e;var p=n.useCallback(function(o){var v=_.current,b=v.onResize,g=v.data,m=o.getBoundingClientRect(),S=m.width,w=m.height,E=o.offsetWidth,z=o.offsetHeight,W=Math.floor(S),H=Math.floor(w);if(f.current.width!==W||f.current.height!==H||f.current.offsetWidth!==E||f.current.offsetHeight!==z){var I={width:W,height:H,offsetWidth:E,offsetHeight:z};f.current=I;var $=E===Math.round(S)?S:E,A=z===Math.round(w)?w:z,M=O(O({},I),{},{offsetWidth:$,offsetHeight:A});c==null||c(M,o,g),b&&Promise.resolve().then(function(){b(M,o)})}},[]);return n.useEffect(function(){var o=C();return o&&!a&&ee(o,p),function(){return re(o,p)}},[t.current,a]),n.createElement(te,{ref:u},h?n.cloneElement(s,{ref:y}):s)}var ae=n.forwardRef(ne),ie="rc-observer-key";function oe(e,i){var r=e.children,a=typeof r=="function"?[r]:Y(r);return a.map(function(t,u){var c=(t==null?void 0:t.key)||"".concat(ie,"-").concat(u);return n.createElement(ae,Q({},e,{key:c,ref:u===0?i:void 0}),t)})}var ue=n.forwardRef(oe);ue.Collection=G;function x(e){return e!==void 0}function ve(e,i){var r=i||{},a=r.defaultValue,t=r.value,u=r.onChange,c=r.postState,d=P(function(){return x(t)?t:x(a)?typeof a=="function"?a():a:typeof e=="function"?e():e}),s=B(d,2),f=s[0],h=s[1],R=t!==void 0?t:f,y=c?c(R):R,C=L(u),_=P([R]),p=B(_,2),o=p[0],v=p[1];D(function(){var g=o[0];f!==g&&C(f,g)},[o]),D(function(){x(t)||h(t)},[t]);var b=L(function(g,m){h(g,m),v([R],m)});return[y,b]}export{ue as R,ve as u};
