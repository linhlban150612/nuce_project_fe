import{r as l,U as P,V as He,W as w,_ as We,X as ie,Y as G,Z as mt,$ as pt,a0 as Ve,a1 as le,a2 as gt,a3 as vt,a4 as ht}from"./index-5d1582d4.js";import{B as xt}from"./BaseInput-5f67969b.js";import{u as Ue}from"./useMergedState-a94f801d.js";import{T as bt,g as Ct}from"./index-ef77481e.js";import{t as St}from"./Compact-de17ca2f.js";import{K as $}from"./useZIndex-412122f7.js";import{T as wt}from"./index-8ab4410e.js";import{E as yt,M as De}from"./index-3aef6c56.js";import{g as It}from"./PurePanel-9c90c19c.js";import{F as Ot,u as Et,g as Nt,a as Pt}from"./SearchOutlined-54091923.js";import{D as _t}from"./index-a21a4ee5.js";import{S as Le}from"./index-8ccb2d3a.js";import{i as Mt,g as ze,a as Tt,b as $t,c as Ft,d as Rt,e as jt,f as At}from"./index-c0762df4.js";import{u as Bt}from"./useCSSVarCls-2b45069f.js";function kt(){var e=l.useState({id:0,callback:null}),t=P(e,2),s=t[0],o=t[1],r=l.useCallback(function(u){o(function(a){var c=a.id;return{id:c+1,callback:u}})},[]);return l.useEffect(function(){var u;(u=s.callback)===null||u===void 0||u.call(s)},[s]),r}var Xe=l.createContext(null);function Vt(e){var t=l.useContext(Xe),s=t.notFoundContent,o=t.activeIndex,r=t.setActiveIndex,u=t.selectOption,a=t.onFocus,c=t.onBlur,m=e.prefixCls,d=e.options,x=d[o]||{};return l.createElement(yt,{prefixCls:"".concat(m,"-menu"),activeKey:x.key,onSelect:function(C){var b=C.key,p=d.find(function(S){var v=S.key;return v===b});u(p)},onFocus:a,onBlur:c},d.map(function(g,C){var b=g.key,p=g.disabled,S=g.className,v=g.style,y=g.label;return l.createElement(De,{key:b,disabled:p,className:S,style:v,onMouseEnter:function(){r(C)}},y)}),!d.length&&l.createElement(De,{disabled:!0},s))}var Dt={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}}},Lt=function(t){var s=t.prefixCls,o=t.options,r=t.children,u=t.visible,a=t.transitionName,c=t.getPopupContainer,m=t.dropdownClassName,d=t.direction,x=t.placement,g="".concat(s,"-dropdown"),C=l.createElement(Vt,{prefixCls:g,options:o}),b=l.useMemo(function(){var p;return d==="rtl"?p=x==="top"?"topLeft":"bottomLeft":p=x==="top"?"topRight":"bottomRight",p},[d,x]);return l.createElement(wt,{prefixCls:g,popupVisible:u,popup:C,popupPlacement:b,popupTransitionName:a,builtinPlacements:Dt,getPopupContainer:c,popupClassName:m},r)},zt=function(){return null};function Kt(e){var t=e.selectionStart;return e.value.slice(0,t)}function Ht(e,t){return t.reduce(function(s,o){var r=e.lastIndexOf(o);return r>s.location?{location:r,prefix:o}:s},{location:-1,prefix:""})}function Ke(e){return(e||"").toLowerCase()}function Wt(e,t,s){var o=e[0];if(!o||o===s)return e;for(var r=e,u=t.length,a=0;a<u;a+=1)if(Ke(r[a])!==Ke(t[a])){r=r.slice(a);break}else a===u-1&&(r=r.slice(u));return r}function Ut(e,t){var s=t.measureLocation,o=t.prefix,r=t.targetText,u=t.selectionStart,a=t.split,c=e.slice(0,s);c[c.length-a.length]===a&&(c=c.slice(0,c.length-a.length)),c&&(c="".concat(c).concat(a));var m=Wt(e.slice(u),r.slice(u-s-o.length),a);m.slice(0,a.length)===a&&(m=m.slice(a.length));var d="".concat(c).concat(o).concat(r).concat(a);return{text:"".concat(d).concat(m),selectionLocation:d.length}}function Xt(e,t){e.setSelectionRange(t,t),e.blur(),e.focus()}function Yt(e,t){return!t||e.indexOf(t)===-1}function Gt(e,t){var s=t.value,o=s===void 0?"":s,r=e.toLowerCase();return o.toLowerCase().indexOf(r)!==-1}var qt=["prefixCls","className","style","prefix","split","notFoundContent","value","defaultValue","children","options","open","allowClear","validateSearch","filterOption","onChange","onKeyDown","onKeyUp","onPressEnter","onSearch","onSelect","onFocus","onBlur","transitionName","placement","direction","getPopupContainer","dropdownClassName","rows"],Qt=["suffix","prefixCls","defaultValue","value","allowClear","onChange","classNames","className","disabled"],Zt=l.forwardRef(function(e,t){var s=e.prefixCls,o=e.className,r=e.style,u=e.prefix,a=u===void 0?"@":u,c=e.split,m=c===void 0?" ":c,d=e.notFoundContent,x=d===void 0?"Not Found":d,g=e.value,C=e.defaultValue,b=e.children,p=e.options,S=e.open;e.allowClear;var v=e.validateSearch,y=v===void 0?Yt:v,I=e.filterOption,_=I===void 0?Gt:I,O=e.onChange,F=e.onKeyDown,E=e.onKeyUp,K=e.onPressEnter,M=e.onSearch,H=e.onSelect,q=e.onFocus,W=e.onBlur,ue=e.transitionName,ce=e.placement,de=e.direction,fe=e.getPopupContainer,me=e.dropdownClassName,Q=e.rows,pe=Q===void 0?1:Q,N=He(e,qt),B=l.useMemo(function(){return Array.isArray(a)?a:[a]},[a]),T=l.useRef(null),U=l.useRef(null),R=function(){var n;return(n=T.current)===null||n===void 0||(n=n.resizableTextArea)===null||n===void 0?void 0:n.textArea};w.useImperativeHandle(t,function(){var f;return{focus:function(){var i;return(i=T.current)===null||i===void 0?void 0:i.focus()},blur:function(){var i;return(i=T.current)===null||i===void 0?void 0:i.blur()},textarea:(f=T.current)===null||f===void 0||(f=f.resizableTextArea)===null||f===void 0?void 0:f.textArea}});var Z=l.useState(!1),J=P(Z,2),k=J[0],ee=J[1],ge=l.useState(""),te=P(ge,2),we=te[0],ye=te[1],Ge=l.useState(""),Ie=P(Ge,2),Oe=Ie[0],qe=Ie[1],Qe=l.useState(0),Ee=P(Qe,2),Ne=Ee[0],Pe=Ee[1],Ze=l.useState(0),_e=P(Ze,2),ve=_e[0],he=_e[1],Je=l.useState(!1),Me=P(Je,2),et=Me[0],Te=Me[1],tt=Ue("",{defaultValue:C,value:g}),$e=P(tt,2),V=$e[0],nt=$e[1];l.useEffect(function(){k&&U.current&&(U.current.scrollTop=R().scrollTop)},[k]);var at=w.useMemo(function(){if(S)for(var f=0;f<B.length;f+=1){var n=B[f],i=V.lastIndexOf(n);if(i>=0)return[!0,"",n,i]}return[k,we,Oe,Ne]},[S,k,B,V,we,Oe,Ne]),ne=P(at,4),D=ne[0],xe=ne[1],ae=ne[2],be=ne[3],Ce=w.useCallback(function(f){var n;return p&&p.length>0?n=p.map(function(i){var h;return ie(ie({},i),{},{key:(h=i==null?void 0:i.key)!==null&&h!==void 0?h:i.value})}):n=St(b).map(function(i){var h=i.props,j=i.key;return ie(ie({},h),{},{label:h.children,key:j||h.value})}),n.filter(function(i){return _===!1?!0:_(f,i)})},[b,p,_]),oe=w.useMemo(function(){return Ce(xe)},[Ce,xe]),ot=kt(),rt=function(n,i,h){ee(!0),ye(n),qe(i),Pe(h),he(0)},L=function(n){ee(!1),Pe(0),ye(""),ot(n)},Fe=function(n){nt(n),O==null||O(n)},it=function(n){var i=n.target.value;Fe(i)},Re=function(n){var i,h=n.value,j=h===void 0?"":h,A=Ut(V,{measureLocation:be,targetText:j,prefix:ae,selectionStart:(i=R())===null||i===void 0?void 0:i.selectionStart,split:m}),z=A.text,X=A.selectionLocation;Fe(z),L(function(){Xt(R(),X)}),H==null||H(n,ae)},lt=function(n){var i=n.which;if(F==null||F(n),!!D){if(i===$.UP||i===$.DOWN){var h=oe.length,j=i===$.UP?-1:1,A=(ve+j+h)%h;he(A),n.preventDefault()}else if(i===$.ESC)L();else if(i===$.ENTER){if(n.preventDefault(),!oe.length){L();return}var z=oe[ve];Re(z)}}},st=function(n){var i=n.key,h=n.which,j=n.target,A=Kt(j),z=Ht(A,B),X=z.location,re=z.prefix;if(E==null||E(n),[$.ESC,$.UP,$.DOWN,$.ENTER].indexOf(h)===-1)if(X!==-1){var Y=A.slice(X+re.length),ke=y(Y,m),ft=!!Ce(Y).length;ke?(i===re||i==="Shift"||D||Y!==xe&&ft)&&rt(Y,re,X):D&&L(),M&&ke&&M(Y,re)}else D&&L()},ut=function(n){!D&&K&&K(n)},je=l.useRef(),Ae=function(n){window.clearTimeout(je.current),!et&&n&&q&&q(n),Te(!0)},Be=function(n){je.current=window.setTimeout(function(){Te(!1),L(),W==null||W(n)},0)},ct=function(){Ae()},dt=function(){Be()};return w.createElement("div",{className:G(s,o),style:r},w.createElement(bt,We({ref:T,value:V},N,{rows:pe,onChange:it,onKeyDown:lt,onKeyUp:st,onPressEnter:ut,onFocus:Ae,onBlur:Be})),D&&w.createElement("div",{ref:U,className:"".concat(s,"-measure")},V.slice(0,be),w.createElement(Xe.Provider,{value:{notFoundContent:x,activeIndex:ve,setActiveIndex:he,selectOption:Re,onFocus:ct,onBlur:dt}},w.createElement(Lt,{prefixCls:s,transitionName:ue,placement:ce,direction:de,options:oe,visible:!0,getPopupContainer:fe,dropdownClassName:me},w.createElement("span",null,ae))),V.slice(be+ae.length)))}),Se=l.forwardRef(function(e,t){var s=e.suffix,o=e.prefixCls,r=o===void 0?"rc-mentions":o,u=e.defaultValue,a=e.value,c=e.allowClear,m=e.onChange,d=e.classNames,x=e.className,g=e.disabled,C=He(e,Qt),b=Ue("",{defaultValue:u,value:a}),p=P(b,2),S=p[0],v=p[1],y=function(O){v(O),m==null||m(O)},I=function(){y("")};return w.createElement(xt,{suffix:s,prefixCls:r,value:S,allowClear:c,handleReset:I,className:x,classNames:d,disabled:g},w.createElement(Zt,We({className:d==null?void 0:d.mentions,prefixCls:r,ref:t,onChange:y},C)))});Se.Option=zt;const Jt=e=>{const{componentCls:t,colorTextDisabled:s,controlItemBgHover:o,controlPaddingHorizontal:r,colorText:u,motionDurationSlow:a,lineHeight:c,controlHeight:m,paddingInline:d,paddingBlock:x,fontSize:g,fontSizeIcon:C,colorTextTertiary:b,colorTextQuaternary:p,colorBgElevated:S,paddingXXS:v,paddingLG:y,borderRadius:I,borderRadiusLG:_,boxShadowSecondary:O,itemPaddingVertical:F,calc:E}=e;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ve(e)),ze(e)),{position:"relative",display:"inline-block",height:"auto",padding:0,overflow:"hidden",lineHeight:c,whiteSpace:"pre-wrap",verticalAlign:"bottom"}),Tt(e)),$t(e)),Ft(e)),{"&-affix-wrapper":Object.assign(Object.assign({},ze(e)),{display:"inline-flex",padding:0,"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${t}-suffix`]:{position:"absolute",top:0,insetInlineEnd:d,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto"},[`&:has(${t}-suffix) > ${t} > textarea`]:{paddingInlineEnd:y},[`${t}-clear-icon`]:{position:"absolute",insetInlineEnd:0,insetBlockStart:E(g).mul(c).mul(.5).add(x).equal(),transform:"translateY(-50%)",margin:0,color:p,fontSize:C,verticalAlign:-1,cursor:"pointer",transition:`color ${a}`,"&:hover":{color:b},"&:active":{color:u},"&-hidden":{visibility:"hidden"}}}),"&-disabled":{"> textarea":Object.assign({},Rt(e))},[`&, &-affix-wrapper > ${t}`]:{[`> textarea, ${t}-measure`]:{color:u,boxSizing:"border-box",minHeight:e.calc(m).sub(2),margin:0,padding:`${le(x)} ${le(d)}`,overflow:"inherit",overflowX:"hidden",overflowY:"auto",fontWeight:"inherit",fontSize:"inherit",fontFamily:"inherit",fontStyle:"inherit",fontVariant:"inherit",fontSizeAdjust:"inherit",fontStretch:"inherit",lineHeight:"inherit",direction:"inherit",letterSpacing:"inherit",whiteSpace:"inherit",textAlign:"inherit",verticalAlign:"top",wordWrap:"break-word",wordBreak:"inherit",tabSize:"inherit"},"> textarea":Object.assign({width:"100%",border:"none",outline:"none",resize:"none",backgroundColor:"transparent"},jt(e.colorTextPlaceholder)),[`${t}-measure`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:-1,color:"transparent",pointerEvents:"none","> span":{display:"inline-block",minHeight:"1em"}}},"&-dropdown":Object.assign(Object.assign({},Ve(e)),{position:"absolute",top:-9999,insetInlineStart:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",fontSize:g,fontVariant:"initial",padding:v,backgroundColor:S,borderRadius:_,outline:"none",boxShadow:O,"&-hidden":{display:"none"},[`${t}-dropdown-menu`]:{maxHeight:e.dropdownHeight,margin:0,paddingInlineStart:0,overflow:"auto",listStyle:"none",outline:"none","&-item":Object.assign(Object.assign({},gt),{position:"relative",display:"block",minWidth:e.controlItemWidth,padding:`${le(F)} ${le(r)}`,color:u,borderRadius:I,fontWeight:"normal",lineHeight:c,cursor:"pointer",transition:`background ${a} ease`,"&:hover":{backgroundColor:o},"&-disabled":{color:s,cursor:"not-allowed","&:hover":{color:s,backgroundColor:o,cursor:"not-allowed"}},"&-selected":{color:u,fontWeight:e.fontWeightStrong,backgroundColor:o},"&-active":{backgroundColor:o}})}})})}},en=e=>Object.assign(Object.assign({},At(e)),{dropdownHeight:250,controlItemWidth:100,zIndexPopup:e.zIndexPopupBase+50,itemPaddingVertical:(e.controlHeight-e.fontHeight)/2}),tn=mt("Mentions",e=>{const t=pt(e,Mt(e));return[Jt(t)]},en);var nn=globalThis&&globalThis.__rest||function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(s[o[r]]=e[o[r]]);return s};const{Option:Ye}=Se;function an(){return!0}const on=(e,t)=>{const{prefixCls:s,className:o,rootClassName:r,disabled:u,loading:a,filterOption:c,children:m,notFoundContent:d,options:x,status:g,allowClear:C=!1,popupClassName:b,style:p,variant:S}=e,v=nn(e,["prefixCls","className","rootClassName","disabled","loading","filterOption","children","notFoundContent","options","status","allowClear","popupClassName","style","variant"]),[y,I]=l.useState(!1),_=l.useRef(null),O=vt(t,_),{getPrefixCls:F,renderEmpty:E,direction:K,mentions:M}=l.useContext(ht),{status:H,hasFeedback:q,feedbackIcon:W}=l.useContext(Ot),ue=Pt(H,g),ce=function(){v.onFocus&&v.onFocus.apply(v,arguments),I(!0)},de=function(){v.onBlur&&v.onBlur.apply(v,arguments),I(!1)},fe=l.useMemo(()=>d!==void 0?d:(E==null?void 0:E("Select"))||l.createElement(_t,{componentName:"Select"}),[d,E]),me=l.useMemo(()=>a?l.createElement(Ye,{value:"ANTD_SEARCHING",disabled:!0},l.createElement(Le,{size:"small"})):m,[a,m]),Q=a?[{value:"ANTD_SEARCHING",disabled:!0,label:l.createElement(Le,{size:"small"})}]:x,pe=a?an:c,N=F("mentions",s),B=Ct(C),T=Bt(N),[U,R,Z]=tn(N,T),[J,k]=Et(S),ee=q&&l.createElement(l.Fragment,null,W),ge=G(M==null?void 0:M.className,o,r,Z,T),te=l.createElement(Se,Object.assign({prefixCls:N,notFoundContent:fe,className:ge,disabled:u,allowClear:B,direction:K,style:Object.assign(Object.assign({},M==null?void 0:M.style),p)},v,{filterOption:pe,onFocus:ce,onBlur:de,dropdownClassName:G(b,r,R,Z,T),ref:O,options:Q,suffix:ee,classNames:{mentions:G({[`${N}-disabled`]:u,[`${N}-focused`]:y,[`${N}-rtl`]:K==="rtl"},R),variant:G({[`${N}-${J}`]:k},Nt(N,ue)),affixWrapper:R}}),me);return U(te)},se=l.forwardRef(on);se.Option=Ye;const rn=It(se,"mentions");se._InternalPanelDoNotUseOrYouWillBeFired=rn;se.getMentions=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{prefix:s="@",split:o=" "}=t,r=Array.isArray(s)?s:[s];return e.split(o).map(function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=null;return r.some(c=>u.slice(0,c.length)===c?(a=c,!0):!1),a!==null?{prefix:a,value:u.slice(a.length)}:null}).filter(u=>!!u&&!!u.value)};export{Ye as O};
