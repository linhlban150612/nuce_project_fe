import{c as M,b as q,r as l,x as H,D as R,F as V,C as B,j as t,L as Q}from"./index-5d1582d4.js";import{d as z,C as A}from"./ckeditor-05c5dc69.js";import{n as P}from"./index-d5b70956.js";import{N as o}from"./Notification-b903467d.js";import{F as n}from"./index-2daf2b68.js";import{S as _}from"./index-8ccb2d3a.js";import{R as G,C as u}from"./row-140c9d21.js";import{I as K}from"./index-ef77481e.js";import{U as W}from"./index-1567c69b.js";import{S as T}from"./index-a21a4ee5.js";import{B as X}from"./button-1dd3c86b.js";import{E as Z}from"./EnterOutlined-5a77cb95.js";import{L as v}from"./compact-item-f6aa6deb.js";import{P as J}from"./PlusOutlined-c3648a15.js";import"./iconBase-7dfc76c2.js";import"./render-43f47cb9.js";import"./asyncToGenerator-f41fc0b7.js";import"./ExclamationCircleFilled-3566f72d.js";import"./CloseOutlined-21301cb3.js";import"./useZIndex-412122f7.js";import"./useCSSVarCls-2b45069f.js";import"./index-8ab4410e.js";import"./useMergedState-a94f801d.js";import"./Compact-de17ca2f.js";import"./ResizeObserver.es-f4289e8a.js";import"./SearchOutlined-54091923.js";import"./index-98be3a7d.js";import"./reactNode-ed0d3403.js";import"./collapse-97de76d4.js";import"./useLocale-98ce2b95.js";import"./responsiveObserver-74647030.js";import"./index-c0762df4.js";import"./BaseInput-5f67969b.js";import"./pickAttrs-c42834d1.js";import"./fade-72ecde73.js";import"./useForceUpdate-3f4a0339.js";import"./CheckOutlined-9e439339.js";import"./Overflow-dad1924c.js";import"./PurePanel-9c90c19c.js";import"./index-3f290c1a.js";import"./move-8c08fc05.js";import"./DownOutlined-e8684ab4.js";const Bt=()=>{var y,S,U,L;const{id:d}=M(),g=q(),[c]=n.useForm(),[x,j]=l.useState(null),[p,F]=l.useState(null),[f,b]=l.useState(!1),{data:e,isLoading:k}=H(d||""),[w,{isLoading:E}]=R(),[I]=V(),{data:h}=B();l.useEffect(()=>{var i,a,s,r,m;c.setFieldsValue({descriptionHtml:(i=e==null?void 0:e.data)==null?void 0:i.descriptionHtml,name:(a=e==null?void 0:e.data)==null?void 0:a.name,status:(s=e==null?void 0:e.data)==null?void 0:s.status,imageObjectId:""}),(r=e==null?void 0:e.data)!=null&&r.imageUrl&&j((m=e==null?void 0:e.data)==null?void 0:m.imageUrl)},[e]);const N=async i=>{F(i),b(!0),setTimeout(()=>{const a=URL.createObjectURL(i);j(a),b(!1)},2e3)},O=async i=>{try{delete i.imageObjectId,p==null?(await I({...i,id:d}),o("success","Thành công","Cập nhật thành công"),g("/admin/quan-ly-chuyen-khoa")):await I({...i,id:d}).unwrap().then(a=>{var m;const s=(m=a==null?void 0:a.data)==null?void 0:m.data,r=new FormData;p&&r.append("image",p),s&&r.append("id",s),w(r).unwrap().then(()=>{o("success","Thành công","Cập nhật thành công"),g("/admin/quan-ly-chuyen-khoa")}).catch(C=>{o("error","Lỗi",C.message||C.data.message)})}).catch(a=>{o("error","Lỗi",a.message||a.data.message)})}catch(a){console.error("Error adding specialty:",a),o("error","Lỗi","Thêm không thành công")}};return t.jsxs("div",{className:"",children:[t.jsxs(Q,{to:"/admin/quan-ly-chuyen-khoa",children:["Quay lại ",t.jsx(Z,{})]}),t.jsx("h2",{className:"my-6 mx-16 text-2xl font-semibold",children:"Cập nhật chuyên khoa"}),t.jsx(_,{spinning:k,children:t.jsxs(n,{className:"mx-40",form:c,name:"basic",labelCol:{span:24},wrapperCol:{span:24},onFinish:O,labelWrap:!0,autoComplete:"off",initialValues:{remember:!0},children:[t.jsxs(G,{gutter:16,children:[t.jsx(u,{span:12,children:t.jsx(n.Item,{label:"Tên chuyên khoa",name:"name",rules:[{required:!0,message:"Trường này không được bỏ trống !"},{min:3,message:"Tối thiểu 3 ký tự!"}],children:t.jsx(K,{})})}),t.jsx(u,{span:12,children:t.jsx(n.Item,{label:"Ảnh",name:"imageObjectId",children:t.jsx(W,{beforeUpload:i=>{const a="2";i.size/1024/1024<a?N(i):o("warning","Cảnh báo","Ảnh không được quá "+a.toString()+"MB")},showUploadList:!1,listType:"picture-card",accept:"image/*",children:x?f?t.jsxs("div",{children:[t.jsx(v,{}),t.jsx("div",{style:{marginTop:8},children:"Đang tải ảnh..."})]}):t.jsx("img",{src:x,alt:"Ảnh đã upload",style:{width:"100%"}}):t.jsx("div",{children:f?t.jsxs("div",{children:[t.jsx(v,{}),t.jsx("div",{style:{marginTop:8},children:"Đang tải ảnh..."})]}):t.jsxs("div",{children:[t.jsx(J,{}),t.jsx("div",{style:{marginTop:8},children:"Upload"})]})})})})}),t.jsx(u,{span:12,children:t.jsx(n.Item,{label:"Trạng thái",name:"status",initialValue:(y=e==null?void 0:e.data)==null?void 0:y.status,children:t.jsx(T,{className:"w-full",children:(S=h==null?void 0:h.data)==null?void 0:S.map(i=>t.jsx(T.Option,{value:i.value,children:i.name},i.value))})})})]}),t.jsx(n.Item,{name:"descriptionHtml",label:"Mô tả",rules:[{required:!0,message:"Vui lòng không bỏ trống"}],children:t.jsx(z.CKEditor,{data:(L=(U=e==null?void 0:e.data)==null?void 0:U.descriptionHtml)==null?void 0:L.toString(),editor:A,onChange:(i,a)=>{const s=a.getData();c.setFieldsValue({descriptionHtml:s})}})}),t.jsx(n.Item,{labelAlign:"left",children:t.jsx(X,{type:"primary",htmlType:"submit",className:"bg-blue-500",children:E?t.jsx(P,{className:"animate-spin"}):"Cập nhật"})})]})})]})};export{Bt as default};
